from mitmproxy import http
import json

def request(flow: http.HTTPFlow):
    print(f"[MITM] Intercepted: {flow.request.method} {flow.request.pretty_url}")
    if "/apiv4r11/auth_key" in flow.request.path:
        flow.response = http.Response.make(
            200,
            json.dumps({
                "data": "3C5AEB7C2782902E4CC10506971159D795E04A64A0052DD2AD416036509D199E44B1CD5A2F291B816B213CB70B48F4BF0C35406631EC9C53E335D951A5C5C6960323DDD460C9499119B782E72D8D8EF07635D641A761EB836FDF28BEAF64B1D32C5DADACE46959B745097823E8C995F1F0A8ACB4BCD73006A46B6518961FE1F2244C6A63E21EBB07AEE3CE8CD35C06E70CA59249FE3DF54F9704FBF26BB87E1C3AED689CDFCD4F50A74DE88E4C03C34480946F75651673D46F9B1EF2FB9591B1A37B1F523F7EEBC54AAED43A3148D5FF43A7BCBC1C1187C5FBFC718BDB82BA0A1619E637259BD7D3AD34815106C48905508361EBEB86A0DCF3A918F45C3B4C5F3B08541226FD63DA5D631CB1B7A3C700B4465AFAC756EE863E7098C58919D90809889B85D8000ED03B9A93124F60A73B9F7586ECEC4D66A2E9DDBB78D44B8D004A7DF7781AEE2CF6FB64971440640D0F7C0D24DA204A11BCA3FFD2CE82DB507F045FE6E54252B12FFE48258F0995DE97CCEE048BFFADCB0DE22EE695A9DF27F12046771A3F298E074E39171BD87CDDD700FA64E86BDA7D72FEC5281D6EB6B3883EDBD6C0038B486D8A2F7C64538EDEA163CF583FE457C77E0A4AA0E10EDBF55442B3BD1AC1EEA28CF57CC82CF5C40CCA32FC7D52710AD4EF8E5D6853AF618477C12383CF614D4F28FBF30C136A5CFA860A5E7FCBF447683ADE6F78B1E3A08058118E5BC9C0F646B9764B497B02C414AEB6BCEED1828E1BF78BD5ECAFBF1B0233FBE8E0041A117CF6521DED0DCEFA837C270219ADE79E3036C3F5B65A66A36F4F"
            }),
            {"Content-Type": "application/json"}
        )
