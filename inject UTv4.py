from mitmproxy import http
import json

def request(flow: http.HTTPFlow):
    print(f"[MITM] Intercepted: {flow.request.method} {flow.request.pretty_url}")
    if "/apiv4r11/auth_key" in flow.request.path:
        flow.response = http.Response.make(
            200,
            json.dumps({
                "data": "3A1C15C4F0BC7DF0B4A12DAEC82D27821B4ACBFB90AC913DD8C8BCD9FB857282CDA2239D1C4245B21C6A35B0DAC70DE105A9FF7730CE3BF39369062B77E0C2B58639036195C54E8F78A5AA4D4199198FFEDF8ED820E98B7572E29262FA9AE4E721F9AE33208B7448C24DDE3351F27A2AC9860A59E762A35539720B890B274A73E51F238C551A7F29BB4189AE919B3904D816C71DAC0212542569474F9D635628878F724DD7A6906A51AC2F0627C1A9C4CD9132B60DAEB7286ADE4888768581DB9E975842A4742A032EA7D1099FADBBDFC87FA01F18A88684E39334361F87E224A26F21D63E907D3064F70DE0B7C50422EE8C0D68EC526AC264F2784D3C27932627C83EC3B7D33411D509A184AEB6E89CCF91E0D995D5E7A2932598385F08B3589BAE49552FBC370F740C7C07D34B14B58D854D7FCD7575A87F148C63353DB012C6FF29613EFE3A8C677F254D1F8487063D775056CD5FA26ED1F8C2C30A57500A6E7F495A0D08A00B5B4A76A5DF9912C396E698C179CDD9A9189EDE132A11982B0CE5283CC6F7A2AF6030E6D0C6BF4FDC28DFD19648537C35D2980D97AAC7B57D12EB80488914B44370EF4943F6D84985EF4FE1D2D2D047590C13BFC83D2D52FDCCA14B38139154D10BADAA1691D42CB3136F4352C1C35A0E50D330B77D8F270575B0D32CB36212E09975850F0685AC55C6BB98A2941D029B9DFD0B9E6DB113BB220068D7607E0AF6440CA6A161EF38B13DE7F0CF6173817AA0256543520A6D22948B626D7403A98D810A018BC62BB3B5CFDD8A6809D5868D13A52D0AA8C39A40CE3D45E7761C3AEE0DF8588747F049E8"
            }),
            {"Content-Type": "application/json"}
        )
    elif "/apiv4r11/users" in flow.request.path:
        fake_users = [
            {
                "id": 1791127,
                "username": "jagatsukran",
                "email": "jagatsukran@gmail.com",
                "avatar": "https://vntool.vn/media/default.png"
            }
        ]
        flow.response = http.Response.make(
            200,
            json.dumps(fake_users),
            {"Content-Type": "application/json"}
        )
